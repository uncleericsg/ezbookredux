'use client';

import { Box, CircularProgress, Theme, useTheme } from '@mui/material';
import { lazy, Suspense } from 'react';
import { Routes, Route, Navigate } from 'react-router-dom';

import { ErrorBoundary } from '../../components/error-boundary/ErrorBoundary';

// Lazy load components with named exports
const DashboardOverview = lazy(() => import('./Dashboard/DashboardOverview').then(module => ({ default: module.DashboardOverview })));
const DashboardCalendar = lazy(() => import('./Dashboard/Overview').then(module => ({ default: module.Overview })));
const DashboardSchedule = lazy(() => import('./ServiceQueue').then(module => ({ default: module.ServiceQueue })));

export interface AdminDashboardProps extends React.HTMLAttributes<HTMLDivElement> {}

export const AdminDashboard = ({ className, ...props }: AdminDashboardProps) => {
  const theme = useTheme<Theme>();

  return (
    <Box
      sx={{
        width: '100%',
        height: '100%',
        padding: theme.spacing(3),
        backgroundColor: theme.palette.background.default,
      }}
      className={className}
      {...props}
    >
      <ErrorBoundary>
        <Suspense
          fallback={
            <Box
              sx={{
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                height: '100%'
              }}
            >
              <CircularProgress sx={{ color: theme.palette.primary.main }} />
            </Box>
          }
        >
          <Routes>
            <Route index element={<Navigate to="overview" replace />} />
            <Route path="overview" element={<DashboardOverview />} />
            <Route path="calendar" element={<DashboardCalendar />} />
            <Route path="schedule" element={<DashboardSchedule />} />
            <Route path="*" element={<Navigate to="overview" replace />} />
          </Routes>
        </Suspense>
      </ErrorBoundary>
    </Box>
  );
};

AdminDashboard.displayName = 'AdminDashboard';

export default AdminDashboard;
